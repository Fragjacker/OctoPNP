<form class="form-horizontal">
    <div class="accordion" id="accordion">

        <!-- Tray settings -->
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#tray-settings"><h4>{{ _('Tray') }}</h4></a>
            </div>
            <div id="tray-settings" class="accordion-body collapse in">
                <div class="accordion-inner">
                    <div class="row-fluid">
                        <div class="span4"><h4>{{ _('Tray position') }}</h4></div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">Position of the lower left corner at the rim's outer perimeter. Note that the printer will move to the tray after enabling the vacuum nozzle, so the position must be relative to this nozzle if a firmware-offset is used.
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.position.x">X</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="tray.position.x" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.x">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.position.y">Y</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="tray.position.y" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.y">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.position.z">Z</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="tray.position.z" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.z">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span4"><h4>{{ _('Tray dimension') }}</h4></div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.rows">Rows</label>
                        <div class="controls">
                            <input id="tray.rows" type="number" step="1" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.rows">
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.columns">Columns</label>
                        <div class="controls">
                            <input id="tray.columns" type="number" step="1" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.columns">
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.boxsize">Box size</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="tray.boxsize" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.boxsize">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="tray.rimsize">Rim size</label>
                        <div class="controls">
                             <div class="input-append">
                                <input id="tray.rimsize" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.tray.rimsize">
                                <span class="add-on">mm</span>
                             </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Camera settings -->
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#camera-settings"><h4>{{ _('Cameras') }}</h4></a>
            </div>
            <div id="camera-settings" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="row-fluid">
                        <div class="span1"><strong>{{ _('Name') }}</strong></div>
                        <div class="span3"><strong>{{ _('X') }}</strong></div>
                        <div class="span3"><strong>{{ _('Y') }}</strong></div>
                        <div class="span3"><strong>{{ _('Focus Distance') }}</strong></div>
                        <div class="span2"><strong>{{ _('px/mm') }}</strong></div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span1"><strong>Head</strong></div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.head.x">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.head.y">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.head.z">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                <div class="span2">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.head.pxPerMM">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span1"></div>
                                <div class="span3">Image Path:</div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="text" class="input-xlarge" data-bind="value: settings.plugins.OctoPNP.camera.head.path">
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <div class="span1"></div>
                                <div class="span3">Binarization threshold:</div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="number" step="1.0" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.head.binary_thresh">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span4"><strong>Head grab-script path:</strong></div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="text" class="input-xlarge" data-bind="value: settings.plugins.OctoPNP.camera.head.grabScriptPath">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                        <div class="row-fluid">
                        <div class="span12"></div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span1"><strong>Bed</strong></div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.bed.x">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.bed.y">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                <div class="span3">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.bed.z">
                                        <span class="add-on">mm</span>
                                    </div>
                                </div>
                                 <div class="span2">
                                    <div class="input-append">
                                        <input type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.bed.pxPerMM">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span1"></div>
                                <div class="span3">Image Path:</div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="text" class="input-xlarge" data-bind="value: settings.plugins.OctoPNP.camera.bed.path">
                                    </div>
                                </div>
                            </div>
                            <div class="row-fluid">
                                <div class="span1"></div>
                                <div class="span3">Binarization threshold:</div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="number" step="1.0" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.camera.bed.binary_thresh">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span4"><strong>Bed grab-script path:</strong></div>
                                <div class="span8">
                                    <div class="input-append">
                                        <input type="text" class="input-xlarge" data-bind="value: settings.plugins.OctoPNP.camera.bed.grabScriptPath">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="row-fluid">
                        <div class="span12">
                            <div class="row-fluid">
                                <div class="span4"><strong>Enable image logging:</strong></div>
                                <div class="span8">
                                   <label class="checkbox">
                                        <input type="checkbox" data-bind="checked: settings.plugins.OctoPNP.camera.image_logging">
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>


                </div>
            </div>
        </div>
        <!-- Nozzle settings -->
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#nozzle-settings"><h4>{{ _('Vacuum Nozzle') }}</h4></a>
            </div>
            <div id="nozzle-settings" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="row-fluid">
                        <div class="span4"><h4>{{ _('Nozzle Offset') }}</h4></div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.x">{{ _('X') }}</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="vacnozzle.x" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.vacnozzle.x">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.y">{{ _('Y') }}</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="vacnozzle.y" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.vacnozzle.y">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.y">{{ _('Z pressure offset') }}</label>
                        <div class="controls">
                            <div class="input-append">
                                <input id="vacnozzle.z_pressure" type="number" step="0.01" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.vacnozzle.z_pressure">
                                <span class="add-on">mm</span>
                            </div>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.extruder_nr">{{ _('Extruder number') }}</label>
                        <div class="controls">
                            <input id="vacnozzle.extruder_nr" type="number" step="1" class="input-mini text-right" data-bind="value: settings.plugins.OctoPNP.vacnozzle.extruder_nr">
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.grip_vacuum_gcode">{{ _('Grip vacuum G-code') }}</label>
                        <div class="controls">
                            <textarea rows="4" class="block" id="acnozzle.grip_vacuum_gcode" data-bind="value: settings.plugins.OctoPNP.vacnozzle.grip_vacuum_gcode"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.release_vacuum_gcode">{{ _('Release vacuum G-code') }}</label>
                        <div class="controls">
                            <textarea rows="4" class="block" id="acnozzle.release_vacuum_gcode" data-bind="value: settings.plugins.OctoPNP.vacnozzle.release_vacuum_gcode"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.lift_nozzle_gcode">{{ _('Lift vacuum-nozzle G-code') }}</label>
                        <div class="controls">
                            <textarea rows="4" class="block" id="acnozzle.lift_nozzle_gcode" data-bind="value: settings.plugins.OctoPNP.vacnozzle.lift_nozzle_gcode"></textarea>
                        </div>
                    </div>
                    <div class="row-fluid">
                        <label class="control-label" for="vacnozzle.lower_nozzle_gcode">{{ _('Lower vacuum-nozzle G-code') }}</label>
                        <div class="controls">
                            <textarea rows="4" class="block" id="acnozzle.lower_nozzle_gcode" data-bind="value: settings.plugins.OctoPNP.vacnozzle.lower_nozzle_gcode"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Calibration -->
        <div class="accordion-group">
            <div class="accordion-heading">
                <a class="accordion-toggle" data-toggle="collapse" data-parent="#accordion" href="#calibration"><h4>{{ _('Calibration') }}</h4></a>
            </div>
            <div id="calibration" class="accordion-body collapse">
                <div class="accordion-inner">
                    <div class="row-fluid">
                        <div class="span8">
                            <div>
                                This is an experimental "calibration wizard".
                            </div>
                            <div id="webcam_container" tabindex="0" data-bind="event: { keydown: onKeyDown, mouseover: onMouseOver, mouseout: onMouseOut, focus: onFocus }">
                                <canvas id="headCanvas" width="400" height="400"></canvas>
                            
                                <div class="keycontrol_overlay" data-bind="visible: showKeycontrols">

                                    <div class="keycontrol_overlay_heading">{{ _("Keyboard controls active") }} <a href="#" data-bind="click: toggleKeycontrolHelp"><i data-bind="css: { 'icon-chevron-down': !keycontrolHelpActive(), 'icon-chevron-up': keycontrolHelpActive() }"></i></a></div>
                                    
                                    <div data-bind="visible: keycontrolHelpActive">
                                        <div class="keycontrol_overlay_column">
                                            <kbd>&rarr;</kbd> / <kbd>&larr;</kbd>: {{ _("X Axis") }} +/-<br>
                                            <kbd>&uarr;</kbd> / <kbd>&darr;</kbd>: {{ _("Y Axis") }} +/-<br>
                                        </div>
                                        <div class="keycontrol_overlay_column">
                                            <kbd>1</kbd>, <kbd>2</kbd>, <kbd>3</kbd>, <kbd>4</kbd>: {{ _("Stepsize") }} 0.1, 1, 10, 100mm
                                        </div>
                                    </div>
                                </div>
                                <div data-bind="visible: control.keycontrolPossible">
                                    <small class="muted">{{ _("Hint: If you move your mouse over the picture, you enter keyboard control mode.") }}</small>
                                </div>
                            </div>
                            <div>
                                <strong>Current X-correction: </strong><kbd data-bind="text: offsetCorrectionX"></kbd><br>
                                <strong>Current Y-correction: </strong><kbd data-bind="text: offsetCorrectionY"></kbd>
                            </div>
                        </div>
                        <div class="span4">
			    <button data-bind="click: homeXY, enable: isConnected">{{ _('Home X Y') }}</button><br>
                            <h4>Object pos. on printbed</h4>
                            <div class="form-group">
                                <span>X&nbsp;</span><input id="objectPosX" type="number" step="0.01" class="input-mini text-right" data-bind="value: objectPositionX"></input>
                                <span>Y&nbsp;</span><input id="objectPosY" type="number" step="0.01" class="input-mini text-right" data-bind="value: objectPositionY"></input>
                            </div> 
                            <br><br>

                            <h4>Ex <-> HeadCamera</h4>
                            <button data-bind="click: headCameraOffset, enable: isConnected">{{ _('Camera to object') }}</button><br>
                            E: <input type="number" step="1" class="input-mini text-right" data-bind="value: selectedHeadExtruder">
                            <button data-bind="click: saveHeadCameraOffset, enable: statusHeadCameraOffset">{{ _('Save camera offset') }}</button>
                            <button data-bind="click: saveExtruderHeadCameraOffset, enable: (statusHeadCameraOffset() && isRepetierFirmware())">{{ _('Save extruder offset') }}</button>
                            <span style="color: red" data-bind="visible: !isRepetierFirmware()">Repetier firmware required.</span>
                            <br><br>
                            
                            <h4>Ex <-> BedCamera</h4>
                            <button data-bind="click: bedCameraPosition, enable: isConnected">{{ _('Extruder to Camera') }}</button><br>
                            E: <input type="number" step="1" class="input-mini text-right" data-bind="value: selectedBedExtruder">
                            <button data-bind="click: saveBedCameraPosition, enable: statusBedCameraOffset">{{ _('Save camera offset') }}</button>
                            <button data-bind="click: saveExtruderBedCameraOffset, enable: (statusBedCameraOffset() && isRepetierFirmware())">{{ _('Save extruder offset') }}</button>
                            <span style="color: red" data-bind="visible: !isRepetierFirmware()">Repetier firmware required.</span>
                            <br><br>

                            <h4>BedCamera <-> PNPNozzle</h4>
                            <button data-bind="click: pnpNozzleOffset, enable: isConnected">{{ _('PNPNozzle to Camera') }}</button>
                            <button data-bind="click: savePnpNozzleOffset, enable: statusPnpNozzleOffset">{{ _('Save nozzle offset') }}</button>
                            
                            <h4>Tray position</h4>
                            <button data-bind="click: function() { $root.trayPosition('TL') }, enable: isConnected">{{ _('TL') }}</button>
                            <button data-bind="click: function() { $root.trayPosition('TR') }, enable: isConnected">{{ _('TR') }}</button><br>
                            <button data-bind="click: trayPosition, enable: isConnected">{{ _('BL') }}</button>
                            <button data-bind="click: function() { $root.trayPosition('BR') }, enable: isConnected">{{ _('BR') }}</button>
                            <button data-bind="click: saveTrayPosition, enable: statusTrayPosition">{{ _('Save tray offset') }}</button>
                            <br><br>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
</form>
